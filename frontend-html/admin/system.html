<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>系统设置 - 管理员中心</title>
  <link rel="stylesheet" href="../css/style.css">
  <link rel="stylesheet" href="../css/icons.css">
  <link rel="stylesheet" href="../css/admin.css">
</head>
<body>
  <nav class="navbar">
    <div class="container">
      <a href="../index.html" class="navbar-brand">就业管理系统 - 管理员</a>
      <div class="navbar-menu">
        <span id="adminName"></span>
        <a href="#" id="logoutBtn">退出登录</a>
      </div>
    </div>
  </nav>

  <div class="dashboard-container">
    <div class="sidebar">
      <div class="sidebar-header">
        <h2>管理中心</h2>
      </div>
      <div class="sidebar-menu">
        <a href="dashboard.html" class="menu-item">
          <span class="icon icon-dashboard"></span> 控制台
        </a>
        <a href="users.html" class="menu-item">
          <span class="icon icon-users"></span> 用户管理
        </a>
        <a href="companies.html" class="menu-item">
          <span class="icon icon-building"></span> 企业管理
        </a>
        <a href="jobs.html" class="menu-item">
          <span class="icon icon-briefcase"></span> 职位审核
        </a>
        <a href="statistics.html" class="menu-item">
          <span class="icon icon-dashboard"></span> 数据统计
        </a>
        <a href="system.html" class="menu-item active">
          <span class="icon icon-settings"></span> 系统设置
        </a>
      </div>
    </div>

    <div class="main-content">
      <div class="page-header">
        <h1>系统设置</h1>
      </div>

      <!-- 基本设置 -->
      <div class="content-card">
        <h2><span class="icon icon-settings"></span> 基本设置</h2>
        <form id="basicSettingsForm">
          <div class="form-group">
            <label>系统名称</label>
            <input type="text" class="form-control" value="毕业生就业信息管理系统">
          </div>
          <div class="form-group">
            <label>系统简介</label>
            <textarea class="form-control" rows="3">连接学生与企业，助力就业梦想</textarea>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>系统邮箱</label>
              <input type="email" class="form-control" value="admin@employment.com">
            </div>
            <div class="form-group">
              <label>联系电话</label>
              <input type="tel" class="form-control" value="400-123-4567">
            </div>
          </div>
          <div class="form-group">
            <button type="submit" class="btn btn-primary">
              <span class="icon icon-save"></span> 保存设置
            </button>
          </div>
        </form>
      </div>

      <!-- 审核设置 -->
      <div class="content-card">
        <h2><span class="icon icon-check"></span> 审核设置</h2>
        <form id="auditSettingsForm">
          <div class="form-group">
            <label>
              <input type="checkbox" checked> 企业注册需要审核
            </label>
          </div>
          <div class="form-group">
            <label>
              <input type="checkbox" checked> 职位发布需要审核
            </label>
          </div>
          <div class="form-group">
            <label>
              <input type="checkbox"> 学生简历需要审核
            </label>
          </div>
          <div class="form-group">
            <button type="submit" class="btn btn-primary">
              <span class="icon icon-save"></span> 保存设置
            </button>
          </div>
        </form>
      </div>

      <!-- 安全设置 -->
      <div class="content-card">
        <h2><span class="icon icon-lock"></span> 安全设置</h2>
        <form id="securitySettingsForm">
          <div class="form-group">
            <label>密码最小长度</label>
            <input type="number" class="form-control" value="6" min="6" max="20">
          </div>
          <div class="form-group">
            <label>会话超时时间（分钟）</label>
            <input type="number" class="form-control" value="30" min="5" max="120">
          </div>
          <div class="form-group">
            <label>
              <input type="checkbox" checked> 启用登录验证码
            </label>
          </div>
          <div class="form-group">
            <label>
              <input type="checkbox"> 启用双因素认证
            </label>
          </div>
          <div class="form-group">
            <button type="submit" class="btn btn-primary">
              <span class="icon icon-save"></span> 保存设置
            </button>
          </div>
        </form>
      </div>

      <!-- 邮件设置 -->
      <div class="content-card">
        <h2><span class="icon icon-email"></span> 邮件设置</h2>
        <form id="emailSettingsForm">
          <div class="form-row">
            <div class="form-group">
              <label>SMTP服务器</label>
              <input type="text" class="form-control" placeholder="smtp.example.com">
            </div>
            <div class="form-group">
              <label>SMTP端口</label>
              <input type="number" class="form-control" placeholder="587">
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>发件人邮箱</label>
              <input type="email" class="form-control" placeholder="noreply@example.com">
            </div>
            <div class="form-group">
              <label>邮箱密码</label>
              <input type="password" class="form-control" placeholder="••••••">
            </div>
          </div>
          <div class="form-group">
            <label>
              <input type="checkbox" checked> 用户注册时发送欢迎邮件
            </label>
          </div>
          <div class="form-group">
            <label>
              <input type="checkbox" checked> 审核通过时发送通知邮件
            </label>
          </div>
          <div class="form-group">
            <button type="submit" class="btn btn-primary">
              <span class="icon icon-save"></span> 保存设置
            </button>
            <button type="button" class="btn btn-outline-secondary" onclick="testEmail()">
              <span class="icon icon-email"></span> 测试邮件
            </button>
          </div>
        </form>
      </div>

      <!-- 数据管理 -->
      <div class="content-card">
        <h2><span class="icon icon-database"></span> 数据管理</h2>
        <div style="display: flex; flex-direction: column; gap: 15px;">
          <div style="padding: 15px; background: #f8f9fa; border-radius: 8px;">
            <h3 style="margin: 0 0 10px 0; font-size: 1.1em;">数据备份</h3>
            <p style="color: #666; margin-bottom: 15px;">定期备份系统数据，确保数据安全</p>
            <button class="btn btn-primary" onclick="backupData()">
              <span class="icon icon-download"></span> 立即备份
            </button>
            <span style="margin-left: 15px; color: #666;">最后备份：2024-12-05 02:00:00</span>
          </div>
          
          <div style="padding: 15px; background: #fff3cd; border-radius: 8px;">
            <h3 style="margin: 0 0 10px 0; font-size: 1.1em;">清理过期数据</h3>
            <p style="color: #666; margin-bottom: 15px;">清理30天前的系统日志和临时数据</p>
            <button class="btn btn-warning" onclick="cleanData()">
              <span class="icon icon-delete"></span> 清理数据
            </button>
          </div>
          
          <div style="padding: 15px; background: #f8d7da; border-radius: 8px;">
            <h3 style="margin: 0 0 10px 0; font-size: 1.1em;">危险操作</h3>
            <p style="color: #721c24; margin-bottom: 15px;">⚠️ 以下操作会影响系统数据，请谨慎操作</p>
            <button class="btn btn-danger" onclick="resetSystem()">
              <span class="icon icon-warning"></span> 重置系统
            </button>
          </div>
        </div>
      </div>

      <!-- 系统信息 -->
      <div class="content-card">
        <h2><span class="icon icon-info"></span> 系统信息</h2>
        <table class="data-table">
          <tr>
            <td style="width: 200px;"><strong>系统版本</strong></td>
            <td>v1.0.0</td>
          </tr>
          <tr>
            <td><strong>后端版本</strong></td>
            <td>Spring Boot 2.7.14</td>
          </tr>
          <tr>
            <td><strong>数据库版本</strong></td>
            <td>MySQL 8.0</td>
          </tr>
          <tr>
            <td><strong>部署环境</strong></td>
            <td>Development</td>
          </tr>
          <tr>
            <td><strong>系统启动时间</strong></td>
            <td>2025-12-05 08:00:00</td>
          </tr>
          <tr>
            <td><strong>系统运行时间</strong></td>
            <td>10小时25分钟</td>
          </tr>
        </table>
      </div>
    </div>
  </div>

  <script src="../js/api.js"></script>
  <script src="../js/auth.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', async () => {
      const user = getCurrentUser();
      const role = getUserRole();
      if (!user || role !== 'admin') {
        window.location.href = '../login.html?role=admin';
        return;
      }

      document.getElementById('adminName').textContent = user.name || user.username || '管理员';
      bindEvents();
    });

    function bindEvents() {
      document.getElementById('logoutBtn').addEventListener('click', (e) => {
        e.preventDefault();
        logout();
        window.location.href = '../login.html?role=admin';
      });

      // 表单提交处理
      document.getElementById('basicSettingsForm').addEventListener('submit', (e) => {
        e.preventDefault();
        alert('基本设置已保存！');
      });

      document.getElementById('auditSettingsForm').addEventListener('submit', (e) => {
        e.preventDefault();
        alert('审核设置已保存！');
      });

      document.getElementById('securitySettingsForm').addEventListener('submit', (e) => {
        e.preventDefault();
        alert('安全设置已保存！');
      });

      document.getElementById('emailSettingsForm').addEventListener('submit', (e) => {
        e.preventDefault();
        alert('邮件设置已保存！');
      });
    }

    function testEmail() {
      alert('测试邮件已发送到系统管理员邮箱！');
    }

    function backupData() {
      if (confirm('确定要备份系统数据吗？')) {
        alert('数据备份已开始，请稍候...');
      }
    }

    function cleanData() {
      if (confirm('确定要清理过期数据吗？此操作不可恢复！')) {
        alert('数据清理已完成！');
      }
    }

    function resetSystem() {
      const confirmation = prompt('这是一个危险操作！请输入"RESET"确认重置系统：');
      if (confirmation === 'RESET') {
        alert('系统重置功能仅限超级管理员使用！');
      }
    }
  </script>
</body>
</html>
